{% load static %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>{% block subtitle %}{% endblock %}</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<meta http-equiv="Content-Language" content="utf-8" />
    <!-- PatternFly Styles -->
    <link rel="stylesheet" href="{% static 'patternfly/dist/css/patternfly.min.css' %}">
    <link rel="stylesheet" href="{% static 'patternfly/dist/css/patternfly-additions.min.css' %}">

    <!-- JS -->
    <script src="{% static 'patternfly/node_modules/jquery/dist/jquery.min.js' %}"></script>
    <script src="{% static 'patternfly/node_modules/bootstrap/dist/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'patternfly/dist/js/patternfly.min.js' %}"></script>

	<link rel="stylesheet" type="text/css" href="{% static 'style/jquery/ui/cupertino/jquery-ui-1.8.20.css' %}" />
	<link rel="stylesheet" type="text/css" href="{% static 'style/base.css' %}" media="screen" />
	<link rel="stylesheet" type="text/css" href="{% static 'style/print.css' %}" media="print" />
	{% block custom_stylesheet %}{% endblock %}
	<script type="text/javascript" src="{% static 'admin/js/vendor/jquery/jquery.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'admin/js/jquery.init.js' %}"></script>

	<script type="text/javascript" src="{% static 'js/lib/jquery-1.7.2.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/lib/jquery-ui-1.8.20.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/lib/handlebars-1.3.0.min.js' %}"></script>
	<script type="text/javascript" language="javascript" charset="utf-8">
		jQuery.noConflict();
		var jQ = jQuery;
		// Top level namespace
		window.Nitrate = {};
	</script>
	<script type="text/javascript" src="{% static 'js/lib/jquery.shiftcheckbox.js' %}"></script>
	<script type="text/javascript" src="{% static 'js/tcms_actions.js' %}"></script>

	{% block custom_javascript %}{% endblock %}
	<script type="text/javascript">
	{% if request.user.is_authenticated %}
	Nitrate.User = {
		pk: {{ request.user.pk }},
		username: '{{ request.user.username }}',
		email: '{{ request.user.email }}',
	};
	{% else %}
	Nitrate.User = {
		pk: null,
		username: 'anonymous',
		email: 'anonymous@anywhere.com',
	};
	{% endif %}
	</script>
		{% block extra_head %}{% endblock %}
</head>
<body id="body">
    <!-- PatternFly Horizontal Nav -->
    <nav class="navbar navbar-default navbar-pf" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">
                <img src="node_modules/patternfly/dist/img/brand.svg" alt="Kiwi TCMS" />
            </a>
        </div>
        <div class="collapse navbar-collapse navbar-collapse-1">
            <ul class="nav navbar-nav navbar-utility">

                <li class="dropdown" style="float:right">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        <span class="pficon pficon-user"></span>
                        {% if user.is_authenticated %}{{ user }}{% else %}Welcome Guest{% endif %}
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                    {% if user.is_authenticated %}
                        <li>
                            <a href="{% url "testruns-all" %}?people={{ user.email }}">My Test Runs</a>
                        </li>

                        <li>
                            <a href="{% url "plans-all" %}?author__email__startswith={{ user.email }}">My Test Plans</a>
                        </li>

                        <li>
                            <a href="{% url 'tcms-bookmark' user.username %}">My bookmarks</a>
                        </li>

                        <li class="divider"></li>

                        <li>
                            <a href="{% url "tcms-profile" user.username %}">My profile</a>
                        </li>

                        <li>
                            <a href="{% url "tcms-password_change" %}">Change password</a>
                        </li>

                        <li class="divider"></li>

                        {% if AUTH_BACKEND.can_logout %}
                        <li>
                            <a href="{% url "tcms-logout" %}?next={{ request.path }}">Logout</a>
                        </li>
                        {% endif %}

                    {% else %}
                        {% if AUTH_BACKEND.can_login %}
                        <li>
                            <a href="{% url "tcms-login" %}?next={{ request.path }}">Login</a>
                        </li>
                        {% endif %}

                        <li class="divider"></li>

                        {% if AUTH_BACKEND.can_register %}
                        <li>
                            <a href="{% url "tcms-register" %}?next={{ request.path }}">Register</a>
                        </li>
                        {% endif %}
                    {% endif %}
                    </ul>
                </li>

                <li class="dropdown" style="float:right">
                    <a class="nav-item-iconic" id="horizontalDropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        <span title="Help" class="fa pficon-help"></span>
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="horizontalDropdownMenu1">
                        {% for link in SETTINGS.FOOTER_LINKS %}
                        <li><a href="{{ link.0 }}">{{ link.1 }}</a></li>
                        {% endfor %}
                        <li class="divider"></li>
                        <li><a href="#">Version {{ SETTINGS.KIWI_VERSION }}</a></li>
                    </ul>
                </li>

                {% if user.is_authenticated %}
                <li style="float:right">
                    <a class="nav-item-iconic fa fa-bookmark-o" id="bookmark_submit" title="Bookmark" href="#"></a>

                    <form id="id_bookmark_iform" action="{% url "tcms-bookmark" user.username %}" method="get">
                        <input type="hidden" name="a" value="render_form" />
                        <input type="hidden" name="user" value="{{ request.user.pk }}" />
                        <input type="hidden" name="site" value="{{ SETTINGS.SITE_ID }}" />
                        {% block content_type %}{% endblock %}
                    </form>
                </li>
                {% endif %}

            </ul>

            <ul class="nav navbar-nav navbar-primary">
                <li>
                    <a href="{% url "core-views-index" %}">DASHBOARD</a>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        TESTING
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        {% if perms.testplans.add_testplan %}
                        <li>
                            <a href="{% url "plans-new" %}">New Test Plan</a>
                        </li>
                        {% endif %}

                        <li class="divider"></li>

                        {% if perms.testcases.add_testcase %}
                        <li>
                            <a href="{% url "testcases-new" %}">New Test Case</a>
                        </li>
                        {% endif %}
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        SEARCH
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="{% url "plans-all" %}">Search Test Plans</a>
                        </li>

                        <li>
                            <a href="{% url "testruns-all" %}">Search Test Runs</a>
                        </li>

                        <li>
                            <a href="{% url "testcases-search" %}">Search Test Cases</a>
                        </li>

                        <li class="divider"></li>

                        <li>
                            <a href="{% url "advance_search" %}">Advanced search</a>
                        </li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        REPORTING
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="{% url "report-overall" %}">Overall report</a>
                        </li>
                        <li>
                            <a href="{% url "report-custom" %}">Custom report</a>
                        </li>
                        <li>
                            <a href="{% url "testing-report" %}">Testing report</a>
                        </li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        ADMIN
                        <b class="caret"></b>
                    </a>

                    <ul class="dropdown-menu">
                        <li class="dropdown-submenu">
                            <a tabindex="-1" href="#">Environment</a>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="{% url "mgmt-environment_groups" %}">Groups</a>
                                </li>
                                <li>
                                    <a href="{% url "mgmt-environment_properties" %}">Properties</a>
                                </li>
                            </ul>
                        </li>

                        <li class="divider"></li>

                    {% if user.is_staff %}
                        {% if perms.auth.change_user %}
                        <li>
                            <a href="{{ SETTINGS.ADMIN_PREFIX }}/auth/">Users and groups</a>
                        </li>
                        {% endif %}

                        {% if perms.management %}
                        <li>
                            <a href="{{ SETTINGS.ADMIN_PREFIX }}/management/">TCMS management</a>
                        </li>
                        {% endif %}

                        {% if perms.testplans.change_testplantype %}
                        <li>
                            <a href="{{ SETTINGS.ADMIN_PREFIX }}/testplans/">Test Plans</a>
                        </li>
                        {% endif %}

                        {% if perms.testcases %}
                        <li>
                            <a href="{{ SETTINGS.ADMIN_PREFIX }}/testcases/">Test Cases</a>
                        </li>
                        {% endif %}

                        <li class="divider"></li>

                        <li>
                            <a href="{{ SETTINGS.ADMIN_PREFIX }}">Everything else</a>
                        </li>
                    {% endif %}
                    </ul>
                </li>
            </ul>
        </div>
    </nav>


    {% block contents %}{% endblock %}
    <div id="dialog" style="display:none"><div class="ajax_loading"></div></div>
</body>
</html>
